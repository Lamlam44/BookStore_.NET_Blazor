@inherits LayoutComponentBase
@inject NavigationManager Navigation
@inject AuthenticationStateProvider AuthProvider

<div class="admin-layout d-flex">
    <aside class="sidebar bg-light border-end" style="width:240px;">
        <NavMenu />
    </aside>
    <div class="flex-grow-1">
        <div class="top-row px-4 bg-white shadow-sm">
            <AuthorizeView>
                <Authorized Context="auth">
                    <span class="me-3">Xin chào, <strong>@auth.User.Identity?.Name</strong></span>
                    <button class="btn btn-link ms-3" @onclick="Logout">Đăng xuất</button>
                </Authorized>
                <NotAuthorized>
                    <a href="/login" class="ms-3">Đăng nhập</a>
                </NotAuthorized>
            </AuthorizeView>
        </div>

        <header class="bg-white p-3 border-bottom">
            <div class="container-fluid">
                <h4 class="m-0">Quản trị</h4>
            </div>
        </header>

        <main class="p-4">
            @Body
        </main>
    </div>
</div>

@code {
    private async Task Logout()
    {
        if (AuthProvider is StoreManagement.Client.Services.CustomAuthenticationStateProvider customAuthProvider)
        {
            await customAuthProvider.MarkUserAsLoggedOut();
        }
        Navigation.NavigateTo("/");
    }
}
